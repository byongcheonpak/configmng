spring.cloud.gateway:
  routes: 
  - id: webhook-test1
    uri: lb://webhook
    predicates:
    - Path=/webhook/**   
    filters:
    - RewritePath=/webhook/(?<uri>.*), /${uri}

# Before, After, Between
  - id: hystrix-producer-event 
    uri: lb://hystrix-producer
    predicates:
    - Path=/hystrix-producer/**
    - Between=2021-02-07T00:00:00+09:00[Asia/Seoul],2021-02-07T23:59:59+09:00[Asia/Seoul]
    filters:
    - RewritePath=/hystrix-producer/(?<segment>.*), /coffees/delay  # Rewrite rule
    - PrefixPath=/api  #무조건 앞에 붙이는 문자열 
  
  - id: hystrix-producer-old
    uri: lb://hystrix-producer
    predicates: 
    - Path=/api/coffees/**
    - Before=2020-12-31T23:59:59+09:00[Asia/Seoul]

  - id: hystrix-producer-new
    # ex) /hystrix-producer/coffees/pass => <uri>/api/coffees/pass
    uri: lb://hystrix-producer
    predicates:
    - Path=/hystrix-producer/**
    - After=2021-01-01T00:00:00+09:00[Asia/Seoul]
    filters:
    - RewritePath=/hystrix-producer/(?<apiuri>.*), /${apiuri}  # 그룹갭처 '(?<group>pattern)', group명에 특수문자 쓰지 않기 
    - PrefixPath=/api  #무조건 앞에 붙이는 문자열 

# Predicates: Cookie
  - id: hystrix-producer-cookie
    uri: lb://hystrix-producer
    predicates:
    - Path=/cookie/**
    - Cookie=LTPAToken,* 
    filters: 
    - RewritePath=/(.*), /api/coffees/pass  

# Predicates: Header
  - id: hystrix-producer-header 
    uri: lb://hystrix-producer
    predicates:
    - Path=/header/**
    - Header=User-Agent, .+Chrome.*   #only chrome support
    - Header=Host, ^gateway.*         #only from host which start 'gateway' 
    filters: 
    - RewritePath=/(.*), /api/coffees/pass    

# Predicates: Host
  - id: hystrix-producer-host 
    uri: lb://hystrix-producer
    predicates:
    - Path=/host/**
    - Host=scg.**, **.myorg.com   #not regrexp, but Ant-style pattern(?, *. **).
    filters: 
    - RewritePath=/(.*), /api/coffees/pass
